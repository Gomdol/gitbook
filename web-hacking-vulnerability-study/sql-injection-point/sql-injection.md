# SQL Injection 대응 방법

### Prepared Statement

SQL 질의문을 미리 컴파일 한다.



select \~\~\~ where id=' qwerwqer '

<mark style="color:red;">컴파일 해둠 = 기계어로 다 바꿈</mark> 구멍을 뽕 뚫어놓고, 나머지는 기계어로 컴파일 해둠.

10101100100qwerwqer&#x20;

1010110010010101100

속도 좋게 하려고 만들었는데, 보안도 좋아진다.



***



### Prepared Statement로 막을 수 있다면, SQLi는 왜 배웠지?&#x20;

다음의 경우에 취약점이 발생할 수 있기 때문이다.



#### **1. Prepared Statement를 잘못 쓴 경우**

? 물음표 문법을 사용하지 않고, 그냥 개발하던 방식 그대로 작성한 경우 발생

#### **2. 못 쓰는 경우 (적용이 안 되는 곳)**

1. order by 절&#x20;
   1. 파라미터에 sort나 ord 가 있다면 무조건 확인해봐야 한다.&#x20;
2. table 이름, column 이름&#x20;
   1. where --- like\
      \* sort나 ord가 있다면 무조건 테스트 해 볼 것.



***

### White List Filtering

* column 이름이라서 Prepared Statement를 못 쓰는 경우 사용함.



필터링 : 단어



화이트 > 특정 단어만 쓸 수 있게 하는 것.&#x20;

블랙 > 특정 단어를 못 쓰게 하는 것.



<mark style="color:red;">**화이트리스트 방식으로 필터링**</mark>** 한다.**



if(sort == 'title'){&#x20;

}elif(sort == 'author')&#x20;

else{&#x20;

&#x20;   sort = 'title';&#x20;

}

위와 같은 방식으로 화이트리스트 필터를 하면 막을 수 있다.







